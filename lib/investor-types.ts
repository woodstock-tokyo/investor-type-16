// lib/investor-types.ts

// ==== 型定義 ====

export type RiskChar = "R" | "S";      // Risk / Secure
export type DecisionChar = "A" | "C";  // Autonomous / Collective
export type TimeChar = "T" | "L";      // Tactical / Long-term
export type JudgeChar = "D" | "V";     // Data / Value;

export type InvestorCode =
  `${RiskChar}${DecisionChar}${TimeChar}${JudgeChar}`;

type Axis = "risk" | "decision" | "time" | "judge";

// 5段階: 1=全くそう思わない / 3=どちらでもない / 5=とてもそう思う
export type AnswerValue = 1 | 2 | 3 | 4 | 5;

export interface InvestorQuestion {
  id: number;
  text: string;
  axis: Axis;
  /**
   * 回答(1〜5)から -2〜+2 に正規化した値に、このweightsを掛けてスコア加算する。
   * 対象になるのは該当軸の2文字のみ。
   *
   * 例:
   * axis: "risk", weights: { R: 1 }
   *   → 賛成側ならRにプラス、反対ならマイナス。
   *
   * axis: "risk", weights: { S: 1 }
   *   → 賛成側でSにプラス。
   */
  weights: Partial<Record<RiskChar | DecisionChar | TimeChar | JudgeChar, number>>;
}

export interface InvestorTypeMeta {
  code: InvestorCode;
  name: string;
  shortLabel: string;
  description: string; // 結果ページ用の長文ここに入れる
  idealStrategy?: string;
  ctaMessage?: string; // CTA用のメッセージ
  bestMatches?: InvestorCode[];
  goodMatches?: InvestorCode[];
  challengeMatches?: InvestorCode[];
}

// ==== 16タイプ定義（中身はあとで好きに埋めてOK） ====
// まずは骨組みだけ。codeとname/shortLabelを確定しとけば運用しやすい。

export const INVESTOR_TYPES: Record<InvestorCode, InvestorTypeMeta> = {
  // R + A + T + D
  RATD: {
    code: "RATD",
    name: "チャートスナイパー",
    shortLabel: "瞬発力の天才トレーダー",
    description: `【基本性格】
あなたは、一瞬のスキを逃さない「チャートの狙撃手」。
ローソク足の形、出来高、トレンドライン──そういうものを見ると脳が勝手に解析モードに入るタイプです。
周りがニュースで騒いでいるころには、あなたはすでに仕込みか撤退を終えていることが多いはず。
感情よりルール、ノリよりシナリオ。勝つための"型"を持っていて、その型に沿って機械的に動ける希少種です。

【強み】
・テクニカルや数字に強く、エントリーとイグジットの基準が明確。
・「なんとなく」でポジらない理性がある。
・負けを認める決断も（他タイプよりは）できる。

【弱み・気をつけること】
・短期売買が増えると、手数料・スプレッド・税金でじわじわ削られがち。
・連勝が続くと自信が増しすぎてロットを跳ね上げてしまう危険あり。
・常に画面を見てしまい、メンタルが疲弊しやすい。

【理想の投資スタイル】
・成長株やボラ高め銘柄の短中期トレード。
・明確な損切りラインと利確ルールを紙に書いて守る。
・余剰資金の一部で勝負しつつ、別枠で長期インデックスも持てるとさらに安定。

【もしこのスタイルを継続できたら…】
例：年間100万円を平均5〜7％狙いで回転＋一部を長期インデックスに回すと、10年後には「ただの貯金勢」とは明確に差がつくポジション。
もちろん全ては自己判断ですが、"武器を持っている側"の人間です。`,
    idealStrategy: "短中期トレード＋一部長期インデックス。明確な売買ルールとリスク管理の徹底。",
    ctaMessage: "チャートを読む腕があるなら、コストで自分を削らんでええ。woodstock.clubで手数料ゼロ環境に移して、同じトレードでも残る利益を増やそう。",
    bestMatches: ["RATV", "SALD"],
    goodMatches: ["SALV"],
    challengeMatches: ["RCLV"],
  },
  // R + A + T + V
  RATV: {
    code: "RATV",
    name: "トレンドハンター",
    shortLabel: "嗅覚の鋭い開拓者",
    description: `【基本性格】
あなたは、「これ来るな」を嗅ぎ分ける未来センサーの持ち主。
AI、半導体、宇宙、ゲーム、サステナブル──胸が高鳴るテーマを見つけた瞬間、すでに手は動きかけているはず。
理屈よりも「世界観」で判断する部分がありつつ、当て感も悪くないので、周囲からすると"よう分からんけど結果出してる人"。

【強み】
・新しいテーマをいち早くキャッチするアンテナ。
・「動きたいときにちゃんと動ける」行動力。
・ワクワクを原動力にできるので、投資を継続しやすい。

【弱み・気をつけること】
・ストーリーに惚れ込みすぎて、高値掴み＆握力無限コースになりがち。
・根拠がふわっとしたままロットを上げると危険。
・「逃げ時」も直感に任せてしまい、気づいたら戻ってこない価格帯にいることも。

【理想の投資スタイル】
・テーマ株／グロース株を複数分散して、"推し"をポートフォリオ化。
・短期の波は楽しみつつ、中核には長期で信じられる企業を置く。
・「これ来る」だけでなく「どこで降りるか」もセットで決めておく。

【もしこのスタイルを磨いたら…】
例：年80〜120万円をテーマ分散で投じ、平均5〜7％で10年転がせれば、ただの浪費ではなく"物語に乗った資産"がしっかり積み上がる。`,
    idealStrategy: "テーマ分散＋長期コア銘柄＋利確ルール。物語とルールの両立。",
    ctaMessage: "次の\"これ来る\"を感じたときにすぐ動ける場所を持っとこ。woodstock.clubで話題テーマをウォッチリスト化して、自分の勘を証明しよう。",
    bestMatches: ["RATD"],
    goodMatches: ["RCLV"],
    challengeMatches: ["SCLV"],
  },
  // R + A + L + D
  RALD: {
    code: "RALD",
    name: "成長コレクター",
    shortLabel: "戦略的な資産家",
    description: `【基本性格】
あなたは「時間もデータも味方につける現実派の野心家」。
短期のノリではなく、長期成長が期待できる企業を選び、数年〜10年スパンで握ることができる。
ただのホールドではなく、"定期的なチェックと微調整"込みで運用できるあたり、かなりプロ思考。

【強み】
・成長ストーリーと財務数字を両方見られるバランス感覚。
・長期で信じるから、多少の下落でも折れない軸を持てる。
・「積立」と「見直し」のリズムを自分で作れる。

【弱み・気をつけること】
・やる気が高いゆえに銘柄数が増えすぎて、管理が甘くなる危険。
・含み損銘柄に"情"がわいて、見直しが遅れることも。

【理想の投資スタイル】
・有望成長株／インデックスを軸に、中長期保有。
・四半期〜半年に一度、冷静にリバランス。
・テーマ株はスパイス程度に。

【もしこのスタイルを続けたら…】
例：年150万円を平均5％で12年積み上げれば、2,500万円超えも現実的なレンジ。
コツコツやってるつもりが、振り返ったら"資産家側"に立ってるタイプです。`,
    idealStrategy: "成長株＋インデックス＋定期リバランスで中長期グロースを狙う。",
    ctaMessage: "あなたの\"成長コレクション\"を散らかしたままにせんでええ。woodstock.clubでポートフォリオを一元管理して、戦略通りに育ってるか可視化しよう。",
    bestMatches: ["RCLD", "SALD"],
    goodMatches: ["RATD"],
    challengeMatches: ["RATV"],
  },
  // R + A + L + V
  RALV: {
    code: "RALV",
    name: "ビジョンドリーマー",
    shortLabel: "未来を描く夢想家",
    description: `【基本性格】
あなたは「世界観ごと買う」タイプ。
この企業は世界を少し良くしてくれそう、このサービスは10年後の当たり前になりそう──そう感じた瞬間から、投資は"共犯関係"になる。
数字も見るけど最終判断は「この物語に自分のお金を乗せたいかどうか」。

【強み】
・一度「これは」と決めた対象を長く応援できる。
・変化の大きい時代にも、自分なりの未来像を持って動ける。
・結果的に、長期グロース株と相性が良い。

【弱み・気をつけること】
・思い入れが強すぎて撤退が遅れる。
・ビジョン先行で、財務や事業リスクを軽く見積もりがち。

【理想の投資スタイル】
・ESG、イノベーション企業、長期テーマETFなどを長く持つ。
・年次で冷静に「物語がまだ続いているか」「数字が追いついているか」を確認。

【もしこのスタイルを活かせたら…】
例：年300万円×15年、年6％達成できれば8,000万円超えも理論上は視野。
"推し"を推し続ける力が、そのまま資産に変わるポテンシャル。`,
    idealStrategy: "ビジョンに共感できる企業＋長期ホールド＋年次レビュー。",
    ctaMessage: "共感で選ぶ投資家こそ、情報の精度が命。woodstock.clubで企業のストーリーと数字を並べて見て、本気で応援できる銘柄だけ残そう。",
    bestMatches: ["RCLD"],
    goodMatches: ["RATD", "SALD"],
    challengeMatches: ["RCLV"],
  },
  // R + C + T + D
  RCTD: {
    code: "RCTD",
    name: "情報ハンター",
    shortLabel: "情報の目利きトレーダー",
    description: `【基本性格】
あなたは「情報戦のフロントランナー」。
ニュース、SNS、決算、海外メディア──あらゆるソースから拾った断片を整理して、自分なりの結論に落とし込むのが得意。
"とりあえず誰かの真似をする"のではなく、"みんなの声を材料に自分で判断する"人です。

【強み】
・一次情報にもアクセスしにいく行動力。
・多面的な視点で市場を捉えられる。
・ファンダもテクニカルも、必要ならちゃんと学ぶタイプ。

【弱み・気をつけること】
・情報量が多すぎて疲れやすい。
・「もっと確証がほしい」と思っているうちにエントリーが遅れることも。
・怪しい情報源をうっかり信じてしまうリスク。

【理想の投資スタイル】
・話題株やニュース敏感銘柄の短中期トレード。
・情報ソースを"3つ以上"持ち、裏取りしてから動く。

【もし力を整えたら…】
例：年120万円を回転させつつ、平均5％前後で着地できれば上出来。
情報処理が得意なあなたは、"正しい場所の情報"さえ集まれば強い。`,
    idealStrategy: "マルチソース情報＋短中期トレード＋検証癖をつける。",
    ctaMessage: "情報戦をやるなら、戦場は選ばんと損。woodstock.clubで投資家コミュニティと一緒に\"ノイズ抜きの情報\"だけ拾い上げよう。",
    bestMatches: ["RATD", "RCLD"],
    goodMatches: ["RATV"],
    challengeMatches: ["SCLV"],
  },
  // R + C + T + V
  RCTV: {
    code: "RCTV",
    name: "バズライダー",
    shortLabel: "波乗り名人トレーダー",
    description: `【基本性格】
あなたは「バズと一緒に動く波乗りプレイヤー」。
XでもYouTubeでも、投資クラスタの熱量を読むのがうまく、「今この銘柄がアツい」を感覚的に掴む。
動き出しも早く、ノればしっかり取る。ただし、降りるタイミングを見誤ると一緒に沈むタイプでもある。

【強み】
・空気を読む力とフットワークの軽さ。
・コミュニティ情報を実際のアクションに変換できる。
・"盛り上がりの初期"を嗅ぎ分けるセンス。

【弱み・気をつけること】
・中身を理解せずにノリだけで買うと危険。
・「まだ上がるかも」で利確を逃しがち。
・逆張りより順張りに偏りすぎて、高値掴みしやすい。

【理想の投資スタイル】
・話題株は少額で短期勝負。
・残りはインデックスや安定株で土台づくり。

【もし上手に乗れたら…】
熱量を追いかける才能は、そのまま"相場のスピード感に対応できる力"。
ルールさえ持てば、強みになる。`,
    idealStrategy: "バズ銘柄は遊び枠、本体は安定資産。メリハリ運用。",
    ctaMessage: "波に乗るのが得意なら、手数料で削られるのはもったいない。woodstock.clubで低コスト環境を確保して、\"当てた分\"を丸ごと残そう。",
    bestMatches: ["RATD", "RATV"],
    goodMatches: ["RCLV"],
    challengeMatches: ["SALV"],
  },
  // R + C + L + D
  RCLD: {
    code: "RCLD",
    name: "チームビルダー",
    shortLabel: "仲間と築く資産形成",
    description: `【基本性格】
あなたは「投資をチーム戦として捉えられる人」。
コミュニティや友人との対話を通じて銘柄を知り、自分でも数字を確認して"納得できる選択"に落とし込む。
一人で抱え込まず、でも思考停止の真似はしない。バランス感覚の良い共同体プレイヤーです。

【強み】
・多様な視点を取り入れられる柔軟性。
・周りに説明できるレベルで理解しようとするため、浅い投資になりにくい。
・自然と「情報のハブ」になれる。

【弱み・気をつけること】
・空気に引っ張られて、自分の本音を見失うことがある。
・グループで盛り上がると、リスク許容度を越えたポジションを取りがち。

【理想の投資スタイル】
・優良株・インデックスを中核に、みんなで研究した銘柄を一部組み込む。
・定期的に「なぜ持っているか」を言語化して棚卸し。

【未来イメージ】
時間をかけて"チーム全体で資産が増えていく"成功体験を作れるタイプ。投資文化を広げる側の人。`,
    idealStrategy: "コアは長期優良株＋インデックス、サテライトをコミュニティで磨く。",
    ctaMessage: "仲間と投資するなら、見える場所を一つに。woodstock.clubで自分のポートフォリオを共有しやすくして、\"語れる投資\"にアップデートしよう。",
    bestMatches: ["RALV", "RALD"],
    goodMatches: ["RCTV"],
    challengeMatches: ["SALV"],
  },
  // R + C + L + V
  RCLV: {
    code: "RCLV",
    name: "共感エバンジェリスト",
    shortLabel: "理念の伝道師",
    description: `【基本性格】
あなたは「推し企業の広報担当か？」と言われるタイプ。
好きになった企業やプロジェクトに、自分の言葉で人を巻き込みながら投資する。
"儲かるから"より"この会社は信じられるから"で動く、熱量の高いエバンジェリスト投資家です。

【強み】
・腰が重く、長期で保有できる。
・社会課題やトレンドへの感度が高く、新しい潮流を早く察知できる。
・人を巻き込む力があり、コミュニティ形成とも相性◎。

【弱み・気をつけること】
・惚れ込みすぎて、悪材料を見て見ぬふりしがち。
・"裏切られた"と感じて感情的に投げ売りするパターンも。

【理想の投資スタイル】
・ESG、テーマ株、クラウドファンディングなど、"意味のあるお金"を意識。
・でも最低限、財務とガバナンスはチェックするクセをつける。

【未来イメージ】
あなたの推し目線が当たれば、「世界を良くしつつ資産も増えてる」状態になり得る。そこを狙える素質は十分。`,
    idealStrategy: "理念に共感できる企業への分散＋最低限のファンダ確認。",
    ctaMessage: "共感投資を本物にするには、情報の裏取りが鍵。woodstock.clubで\"好き\"と\"現実\"を並べて見て、胸を張って推せるポートフォリオを作ろう。",
    bestMatches: ["RATV"],
    goodMatches: ["SCLV"],
    challengeMatches: ["RATD"],
  },
  // S + A + T + D
  SATD: {
    code: "SATD",
    name: "堅実ファイター",
    shortLabel: "慎重なチャレンジャー",
    description: `【基本性格】
あなたは「守りの構えで殴れる人」。
基本は安全志向だが、数字を見て「これは行ける」と判断したものには短期でも踏み込める。
無茶はしないけど、何もしない人でもない。日本人全体から見ると"ちょうど良い攻め方"ができている側です。

【強み】
・リスク管理への意識が高く、大火傷しにくい。
・チャンスもゼロにはしない柔軟さ。

【弱み・気をつけること】
・慎重さが勝ちすぎて、せっかくの分析を行動に移せないことがある。
・複数ポジションを短期で回し出すと、一気に疲れるタイプ。

【理想の投資スタイル】
・高配当・安定株をベースに、一部で短期トレード。
・短期枠の資金量を"総資産の◯％まで"と決めて運用。

【未来イメージ】
守り重視でも、年4〜5％を堅く積めれば「ただ預けてるだけ」の層とはしっかり差が開く。`,
    idealStrategy: "安定株＋一部短期運用。ルールで線を引く。",
    ctaMessage: "慎重さは武器やから、そのままでいい。woodstock.clubで短期も長期も手数料ゼロで試して、\"ルールを守る投資\"を完成させよう。",
    bestMatches: ["SALD"],
    goodMatches: ["RATD"],
    challengeMatches: ["RCTV"],
  },
  // S + A + T + V
  SATV: {
    code: "SATV",
    name: "バランスマスター",
    shortLabel: "調和を極めた達人",
    description: `【基本性格】
あなたは「無茶はしないけど、守りきりもしない」絶妙ポジション。
感覚も大事にするし、リスクもちゃんと気にする。
だからこそ、"なんとなく良さそう"に流されると中途半端になりがちでもある。

【強み】
・暴走しづらく、大事故を起こしにくい。
・状況に応じてスタイルを微調整できる柔軟さ。

【弱み・気をつけること】
・明確な戦略がないまま、雰囲気配分で持ちがち。
・本来取ってもいいリスクまで避けてしまうことも。

【理想の投資スタイル】
・バランス型ファンド＋少額の"好きな銘柄"。
・まずは「この比率で1年続ける」というマイルールを決める。

【未来イメージ】
戦略さえ言語化できれば、一気に"ただの様子見勢"から抜け出せる。`,
    idealStrategy: "バランス型＋少額テーマ。設計図を可視化すること。",
    ctaMessage: "あなたの\"ちょうどいい配分\"を形にしよ。woodstock.clubならポートフォリオ比率を視覚化して、迷わず続けられる。",
    bestMatches: ["SALD", "SALV"],
    goodMatches: ["RCLV"],
    challengeMatches: ["RATV"],
  },
  // S + A + L + D
  SALD: {
    code: "SALD",
    name: "コツコツマスター",
    shortLabel: "堅実な資産家",
    description: `【基本性格】
あなたは「じわじわ勝つ人」。
毎月決まった額を積み立て、無駄な売買をせず、数年単位で物事を見ることができる。
日本全体で見ると、かなりレアな"ちゃんとやってる人"。

【強み】
・継続力がそのまま武器になる。
・複利の怖さも偉大さも理解している。

【弱み・気をつけること】
・退屈さに負けて余計なことをし始めると崩れる。
・安全志向が強すぎて、成長機会を取りこぼすことも。

【理想の投資スタイル】
・インデックス積立＋高配当少し。
・ポートフォリオを年1回だけ見直すくらいの距離感。

【未来イメージ】
月5万円を20年・年4％で積めば約1,475万円。"何もしてない人"との差は歴然。`,
    idealStrategy: "インデックス中心の自動積立運用。",
    ctaMessage: "あなたのコツコツは、ちゃんと可視化した方がモチベ上がる。woodstock.clubで長期積立を一覧化して、\"積んできた歴史\"を見える化しよう。",
    bestMatches: ["SALV"],
    goodMatches: ["RATD", "RALD"],
    challengeMatches: ["RCTV"],
  },
  // S + A + L + V
  SALV: {
    code: "SALV",
    name: "ファミリーガーディアン",
    shortLabel: "守る強さを知る人",
    description: `【基本性格】
あなたは「家族と未来のCFO」。
自分だけでなく、パートナー、子ども、親のことまで含めてお金を考える。
投資は"増やすゲーム"ではなく"守り切る決断"でもあると理解している人です。

【強み】
・生活防衛資金、保険、長期資産のバランスを取ろうとする姿勢。
・無茶をしないことで、大事故を避けられる。

【弱み・気をつけること】
・慎重すぎて、インフレや機会損失に負ける可能性。
・「よく分からないからやらない」で止まると、逆にリスク。

【理想の投資スタイル】
・高配当株＋安定インデックス＋十分な現金。
・目的別口座（教育、老後など）を分けて管理。

【未来イメージ】
攻めてないようで、"長期的にはよく考えられた家計"として報われるタイプ。`,
    idealStrategy: "目的別に分けた安定運用。攻めは控えめでOK。",
    ctaMessage: "家族のための設計図、頭の中だけに置いとかんでいい。woodstock.clubで目的別ポートフォリオを分けて管理して、不安を\"見える安心\"に変えよう。",
    bestMatches: ["SALD"],
    goodMatches: ["SCLD"],
    challengeMatches: ["RATV", "RCTV"],
  },
  // S + C + T + D
  SCTD: {
    code: "SCTD",
    name: "石橋ウォッチャー",
    shortLabel: "確認してから動く人",
    description: `【基本性格】
あなたは「一応全部調べてからポチる人」。
人の意見も聞くし、レビューも読むし、チャートも見る。
慎重だが、その分"納得してエントリーできる"のでブレにくい。

【強み】
・情報を吟味する癖があるので、致命的ミスが少ない。
・短期も触れるが、ちゃんと根拠を欲しがる。

【弱み・気をつけること】
・調べてる間にチャンスが過ぎ去ることがある。
・インフルエンサーの"それっぽい言葉"に弱い一面も。

【理想の投資スタイル】
・優良株中心に、決算やニュースで短期も少し。
・「チェック項目3つクリアしたら買う」などルール化すると◎。

【未来イメージ】
慎重スタイルでも年3〜4％は十分狙える。焦らないこと自体があなたの武器。`,
    idealStrategy: "チェックリスト運用＋軽めの短期売買。",
    ctaMessage: "「ちゃんと調べてから買う」タイプには、ツールが味方。woodstock.clubで銘柄情報をまとめて確認して、\"迷う時間\"を減らそう。",
    bestMatches: ["RATD"],
    goodMatches: ["SCLV"],
    challengeMatches: ["RATV"],
  },
  // S + C + T + V
  SCTV: {
    code: "SCTV",
    name: "空気読みフォロワー",
    shortLabel: "空気を読む投資家",
    description: `【基本性格】
あなたは「孤独に張らないタイプ」。
誰かが話題にしている銘柄、信頼している人が推しているテーマ──そういう"空気"をヒントに動く。
慎重だけど、一歩踏み出すきっかけを他者とのつながりから得るスタイルです。

【強み】
・一人で暴走しない。
・人気銘柄に入るので、情報も多く判断しやすい。

【弱み・気をつけること】
・「みんな買ってるから」で高値掴みしやすい。
・自分の基準を持たないと、永遠に他人任せになる。

【理想の投資スタイル】
・話題の銘柄には"小額で体験参入"。
・本命は、信頼できるインデックスや安定株で長期。

【未来イメージ】
空気を読む能力を、"自分なりの型"とセットにできたら強い。`,
    idealStrategy: "少額トレンド＋長期コアの二階建て。",
    ctaMessage: "雰囲気で終わらせんために。woodstock.clubで自分のポジションを一覧化して、「なんで持ってるか」を一緒に整理しよ。",
    bestMatches: ["RCLV"],
    goodMatches: ["RCTV"],
    challengeMatches: ["RATD"],
  },
  // S + C + L + D
  SCLD: {
    code: "SCLD",
    name: "成長シーカー",
    shortLabel: "学びながら成長する人",
    description: `【基本性格】
あなたは「真面目にちゃんと知りたい人」。
投資に興味はある、もう始めてもいる、でもまだ"自信を持てる型"は模索中。
ググって、動画見て、人の話も聞いて、"分かったつもりで終わりたくない"と感じている成長志向タイプです。

【強み】
・吸収力が高く、変なプライドがないので伸びやすい。
・いきなりフルベットしない慎重さもある。

【弱み・気をつけること】
・学んでばかりでエントリーが遅れる。
・情報ソース次第で簡単に振り回される危険。

【理想の投資スタイル】
・インデックス積立をベースに、「勉強用」として少額の個別株。
・経験と学びをリンクさせていく。

【未来イメージ】
ここから3年ちゃんと継続したら、"ただの初心者"とは別次元になれる位置にいる。`,
    idealStrategy: "長期インデックス＋少額実践で経験値を貯める。",
    ctaMessage: "学びながら実践するなら、環境はシンプルな方がいい。woodstock.clubで手数料を気にせず少額トライして、\"経験の方の資産\"を増やそう。",
    bestMatches: ["SALD", "SALV"],
    goodMatches: ["SCLV"],
    challengeMatches: ["RCTV"],
  },
  // S + C + L + V
  SCLV: {
    code: "SCLV",
    name: "安心キーパー",
    shortLabel: "安心を求める仲間想い",
    description: `【基本性格】
あなたは「自分も周りも傷つけたくない人」。
リスクを最小限にしつつ、世の中や身近な人の話を聞きながら、"無理のない範囲で投資を取り入れたい"と考える。
投資でマウントを取りたいわけじゃなく、「将来ちょっと安心できたらいいな」が本音。

【強み】
・無茶をしない。再起不能な負け方をしづらい。
・共感性が高く、人の失敗談からもちゃんと学べる。

【弱み・気をつけること】
・慎重すぎて、何も始めないまま数年経つリスク。
・周りの声に引きずられ、自分の判断が育たない。

【理想の投資スタイル】
・インデックスファンド＋ESGや共感できる企業にほんの少し。
・現金比率高めでもOK、その上で"ゼロではない投資"を続ける。

【未来イメージ】
少額でも10年スパンで積めば、「やっててよかった」にちゃんと届くタイプ。`,
    idealStrategy: "少額×長期×共感できる対象。背伸びしない。",
    ctaMessage: "不安なまま始める必要はないけど、\"何もせん\"もリスク。woodstock.clubで少額から分散して、あなたのペースのまま一歩踏み出そう。",
    bestMatches: ["SALV", "RCLV"],
    goodMatches: ["SCLD"],
    challengeMatches: ["RATV", "RCTV"],
  },
};

// ==== 質問定義 ====
// 16問構成（4軸 × 各4問）
// value: 1〜5 を -2〜+2 にマップして weights に掛ける仕様。

export const INVESTOR_QUESTIONS: InvestorQuestion[] = [
  // --- Risk: R vs S ---
  {
    id: 1,
    axis: "risk",
    text: "大きなリターンが期待できるなら、多少の値動きは気にせずチャレンジしたい。",
    weights: { R: 1.5 }, // より本質的なリスク許容度を測る
  },
  {
    id: 2,
    axis: "risk",
    text: "投資で一番避けたいのは、大きな損失で夜眠れなくなる状況だ。",
    weights: { S: 1.5 }, // 安全性への強い嗜好
  },
  {
    id: 3,
    axis: "risk",
    text: "新しい商品やテーマに早めに乗る方だ。",
    weights: { R: 1.2 }, // 行動面でのリスク志向
  },
  {
    id: 4,
    axis: "risk",
    text: "元本割れの可能性が高いものには、基本的に手を出したくない。",
    weights: { S: 1.3 }, // 損失回避の明確な意思
  },

  // --- Decision: A vs C ---
  {
    id: 5,
    axis: "decision",
    text: "最終的な投資判断は、自分で調べて自分で決めたい。",
    weights: { A: 1.5 }, // 自律性の核心
  },
  {
    id: 6,
    axis: "decision",
    text: "SNSやインフルエンサー、友人の意見をかなり参考にする。",
    weights: { C: 1.3 }, // 集団志向の行動
  },
  {
    id: 7,
    axis: "decision",
    text: "専門家や他人のおすすめより、自分のルールや基準を優先する。",
    weights: { A: 1.4 }, // 強い独立性
  },
  {
    id: 8,
    axis: "decision",
    text: "みんなが買っているものには安心感を覚える。",
    weights: { C: 1.5 }, // 集団への依存度
  },

  // --- Time: T vs L ---
  {
    id: 9,
    axis: "time",
    text: "数週間〜1年程度の値動きを見ながら、柔軟に売買したい。",
    weights: { T: 1.3 }, // 短期志向の行動
  },
  {
    id: 10,
    axis: "time",
    text: "10年単位で積み立てて育てる投資が自分には合っていると思う。",
    weights: { L: 1.5 }, // 長期投資の本質的な志向
  },
  {
    id: 11,
    axis: "time",
    text: "短期で結果が出ないとモチベーションが下がりやすい。",
    weights: { T: 1.4 }, // 短期的な成果への欲求
  },
  {
    id: 12,
    axis: "time",
    text: "日々の値動きより、長期トレンドや将来像を重視する。",
    weights: { L: 1.4 }, // 長期視点の明確さ
  },

  // --- Judge: D vs V ---
  {
    id: 13,
    axis: "judge",
    text: "PER、売上成長率、チャートなどの数字を見て判断することが多い。",
    weights: { D: 1.5 }, // データ重視の本質
  },
  {
    id: 14,
    axis: "judge",
    text: "企業理念やストーリー、好きかどうかが投資判断に影響する。",
    weights: { V: 1.4 }, // 価値観による判断
  },
  {
    id: 15,
    axis: "judge",
    text: "財務データがよくても、応援したくない企業には投資したくない。",
    weights: { V: 1.5 }, // 価値観優先の強い意思
  },
  {
    id: 16,
    axis: "judge",
    text: "ニュース・指標・チャートを組み合わせて、論理的に結論を出す方だ。",
    weights: { D: 1.3 }, // 論理的アプローチ
  },
];

// ==== ロジック本体 ====

// 回答: { [questionId]: 1〜5 }
export type InvestorAnswers = Record<number, AnswerValue>;

interface ScoreState {
  risk: { R: number; S: number };
  decision: { A: number; C: number };
  time: { T: number; L: number };
  judge: { D: number; V: number };
}

/**
 * 5段階回答を -2〜+2 に変換
 */
function normalize(value: AnswerValue): number {
  // 1→-2, 2→-1, 3→0, 4→+1, 5→+2
  return value - 3;
}

/**
 * 回答から16タイプの4文字コードを算出
 */
export function calculateInvestorCode(answers: InvestorAnswers): InvestorCode {
  const score: ScoreState = {
    risk: { R: 0, S: 0 },
    decision: { A: 0, C: 0 },
    time: { T: 0, L: 0 },
    judge: { D: 0, V: 0 },
  };

  for (const q of INVESTOR_QUESTIONS) {
    const raw = answers[q.id];
    if (!raw) continue;

    const norm = normalize(raw);

    // normが0(=どちらでもない)なら何も加算しない
    if (norm === 0) continue;

    for (const key in q.weights) {
      const k = key as keyof typeof q.weights;
      const weight = q.weights[k];
      if (!weight) continue;

      const delta = norm * weight;

      switch (q.axis) {
        case "risk":
          if (k === "R" || k === "S") {
            // @ts-ignore
            score.risk[k] += delta;
          }
          break;
        case "decision":
          if (k === "A" || k === "C") {
            // @ts-ignore
            score.decision[k] += delta;
          }
          break;
        case "time":
          if (k === "T" || k === "L") {
            // @ts-ignore
            score.time[k] += delta;
          }
          break;
        case "judge":
          if (k === "D" || k === "V") {
            // @ts-ignore
            score.judge[k] += delta;
          }
          break;
      }
    }
  }

  const riskChar: RiskChar = score.risk.R >= score.risk.S ? "R" : "S";
  const decisionChar: DecisionChar =
    score.decision.A >= score.decision.C ? "A" : "C";
  const timeChar: TimeChar = score.time.T >= score.time.L ? "T" : "L";
  const judgeChar: JudgeChar =
    score.judge.D >= score.judge.V ? "D" : "V";

  const code = `${riskChar}${decisionChar}${timeChar}${judgeChar}` as InvestorCode;

  // 念のため安全に
  if (!INVESTOR_TYPES[code]) {
    // 想定外パターン出たら無難なタイプにフォールバック
    return "SALD";
  }

  return code;
}

/**
 * コードからタイプ情報を取得
 */
export function getInvestorType(code: string): InvestorTypeMeta | null {
  const key = code.toUpperCase() as InvestorCode;
  return INVESTOR_TYPES[key] ?? null;
}
